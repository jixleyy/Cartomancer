# Core Concept

Azgaar’s Fantasy Map Generator is essentially a procedural map generator for fantasy worlds. It’s built as a single-page web app, mostly in JavaScript, using Voronoi diagrams and graph theory to define terrain, rivers, climate, biomes, and political regions.

The generator works in layers, where each layer adds complexity and realism to the map.

## Main Steps of the Generator

### Step 1: Base Polygonal Mesh

Voronoi / Delaunay Diagram Generation

The map starts as a set of randomly distributed points.

Voronoi cells are computed from these points to create polygonal regions.

Delaunay triangulation is used to define adjacency and neighborhood relationships.

**Purpose: Provides the basic “tiles” for terrain, elevation, and region assignment.**

### Step 2: Elevation / Terrain

#### Heightmap Generation

Uses noise algorithms (Perlin or Simplex noise) + some randomness to assign elevation.

Mountains, hills, plains, and oceans are determined from this.

#### Erosion Simulation

Optional simulation of river paths and slope-based erosion to make terrain more natural.

#### Edge & corner adjustments

Sea level is applied; outer edges often set to ocean to frame the map.

### Step 3: Rivers

Rivers are generated by:

Starting from high elevation points (“sources” in mountains).

Flowing along the steepest descent paths through the polygon network.

Merging into larger rivers.

Ensures realistic river branching and connections to oceans or lakes.

### Step 4: Biomes & Climate

#### Climate layers are applied

Latitude-based temperature model.

Precipitation model influenced by elevation and proximity to water.

#### Biomes (forest, desert, tundra, etc.) are assigned based on temperature and rainfall thresholds

### Step 5: Political & Administrative Divisions

#### Region Generation

Uses the Voronoi cells and graph structure to define countries, kingdoms, or regions.

Can merge multiple cells into larger territories.

#### Capital / City Placement

Typically at strategic locations: near rivers, coastlines, or resource-rich areas.

Population or city density can be simulated.

### Step 6: Roads & Trade Networks

Connects cities using shortest paths along the Delaunay triangulation.

Roads may follow rivers or coastlines naturally to simulate trade routes.

### Step 7: Map Visualization

#### SVG / Canvas Rendering

Polygons are colored according to terrain, biomes, and regions.

Rivers, roads, and borders are drawn on top.

Optional overlays: grid, elevation shading, population markers.

### Step 8: Export & Interaction

#### Users can

Export maps as PNG or SVG.

Edit regions, terrain, rivers manually.

Save / load map data in JSON format for later tweaks.

## Data Structures

### Key structures you’ll need to understand

#### Vertices / Points: Base random points used for Voronoi/Delaunay

#### Cells / Polygons: Voronoi cells with elevation, biome, political info

#### Edges / Triangles: Delaunay triangulation edges for adjacency, rivers, roads

#### Graph representations

Node = city / region / cell

Edge = river / road / adjacency

## Performance Considerations

Generating thousands of Voronoi cells and updating SVG DOM elements is expensive.

River/road calculations over the graph are O(n²) in naive implementations.

Noise and biome calculations could be memoized or simplified for speed.

SVG rendering may lag with large maps; canvas or WebGL could help.

## Optional Enhancements

Multi-threading (Web Workers) for heavy computations (rivers, erosion).

Progressive generation (generate terrain first, then rivers, then biomes).

Better caching of repeated calculations (noise values, slope, adjacency).

Modular feature toggles (enable/disable erosion, roads, rivers, biomes separately).
